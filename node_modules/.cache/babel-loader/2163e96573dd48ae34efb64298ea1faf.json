{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jalcantara/Desktop/SOL-dev/tanda-wallet-sol/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import{jsx as _jsx}from\"react/jsx-runtime\";import _asyncToGenerator from\"/Users/jalcantara/Desktop/SOL-dev/tanda-wallet-sol/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jalcantara/Desktop/SOL-dev/tanda-wallet-sol/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useSnackbar}from'notistack';import{useConnection,useSolanaExplorerUrlSuffix}from'./connection';import Button from'@material-ui/core/Button';import{confirmTransaction}from'./utils';export function useSendTransaction(){var connection=useConnection();var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar,closeSnackbar=_useSnackbar.closeSnackbar;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),sending=_useState2[0],setSending=_useState2[1];function sendTransaction(_x){return _sendTransaction.apply(this,arguments);}function _sendTransaction(){_sendTransaction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(signaturePromise){var _ref,onSuccess,onError,id,signature,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref=_args.length>1&&_args[1]!==undefined?_args[1]:{},onSuccess=_ref.onSuccess,onError=_ref.onError;id=enqueueSnackbar('Sending transaction...',{variant:'info',persist:true});setSending(true);_context.prev=3;_context.next=6;return signaturePromise;case 6:signature=_context.sent;closeSnackbar(id);id=enqueueSnackbar('Confirming transaction...',{variant:'info',persist:true,action:/*#__PURE__*/_jsx(ViewTransactionOnExplorerButton,{signature:signature})});_context.next=11;return confirmTransaction(connection,signature);case 11:closeSnackbar(id);setSending(false);enqueueSnackbar('Transaction confirmed',{variant:'success',autoHideDuration:15000,action:/*#__PURE__*/_jsx(ViewTransactionOnExplorerButton,{signature:signature})});if(onSuccess){onSuccess(signature);}_context.next=24;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](3);closeSnackbar(id);setSending(false);console.warn(_context.t0);enqueueSnackbar(_context.t0.message,{variant:'error'});if(onError){onError(_context.t0);}case 24:case\"end\":return _context.stop();}}},_callee,null,[[3,17]]);}));return _sendTransaction.apply(this,arguments);}return[sendTransaction,sending];}function ViewTransactionOnExplorerButton(_ref2){var signature=_ref2.signature;var urlSuffix=useSolanaExplorerUrlSuffix();return/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:\"a\",target:\"_blank\",rel:\"noopener\",href:\"https://solscan.io/tx/\".concat(signature)+urlSuffix,children:\"View on Solscan\"});}export function useCallAsync(){var _useSnackbar2=useSnackbar(),enqueueSnackbar=_useSnackbar2.enqueueSnackbar,closeSnackbar=_useSnackbar2.closeSnackbar;return/*#__PURE__*/function(){var _callAsync=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(promise){var _ref3,_ref3$progressMessage,progressMessage,_ref3$successMessage,successMessage,onSuccess,onError,id,result,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref3=_args2.length>1&&_args2[1]!==undefined?_args2[1]:{},_ref3$progressMessage=_ref3.progressMessage,progressMessage=_ref3$progressMessage===void 0?'Submitting...':_ref3$progressMessage,_ref3$successMessage=_ref3.successMessage,successMessage=_ref3$successMessage===void 0?'Success':_ref3$successMessage,onSuccess=_ref3.onSuccess,onError=_ref3.onError;id=enqueueSnackbar(progressMessage,{variant:'info',persist:true});_context2.prev=2;_context2.next=5;return promise;case 5:result=_context2.sent;closeSnackbar(id);if(successMessage){enqueueSnackbar(successMessage,{variant:'success'});}if(onSuccess){onSuccess(result);}_context2.next=17;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](2);console.warn(_context2.t0);closeSnackbar(id);enqueueSnackbar(_context2.t0.message,{variant:'error'});if(onError){onError(_context2.t0);}case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[2,11]]);}));function callAsync(_x2){return _callAsync.apply(this,arguments);}return callAsync;}();}","map":{"version":3,"sources":["/Users/jalcantara/Desktop/SOL-dev/tanda-wallet-sol/src/utils/notifications.js"],"names":["React","useState","useSnackbar","useConnection","useSolanaExplorerUrlSuffix","Button","confirmTransaction","useSendTransaction","connection","enqueueSnackbar","closeSnackbar","sending","setSending","sendTransaction","signaturePromise","onSuccess","onError","id","variant","persist","signature","action","autoHideDuration","console","warn","message","ViewTransactionOnExplorerButton","urlSuffix","useCallAsync","promise","progressMessage","successMessage","result","callAsync"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { useSnackbar } from 'notistack';\nimport { useConnection, useSolanaExplorerUrlSuffix } from './connection';\nimport Button from '@material-ui/core/Button';\nimport { confirmTransaction } from './utils';\n\nexport function useSendTransaction() {\n  const connection = useConnection();\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar();\n  const [sending, setSending] = useState(false);\n\n  async function sendTransaction(\n    signaturePromise,\n    { onSuccess, onError } = {},\n  ) {\n    let id = enqueueSnackbar('Sending transaction...', {\n      variant: 'info',\n      persist: true,\n    });\n    setSending(true);\n    try {\n      let signature = await signaturePromise;\n      closeSnackbar(id);\n      id = enqueueSnackbar('Confirming transaction...', {\n        variant: 'info',\n        persist: true,\n        action: <ViewTransactionOnExplorerButton signature={signature} />,\n      });\n      await confirmTransaction(connection, signature);\n      closeSnackbar(id);\n      setSending(false);\n      enqueueSnackbar('Transaction confirmed', {\n        variant: 'success',\n        autoHideDuration: 15000,\n        action: <ViewTransactionOnExplorerButton signature={signature} />,\n      });\n      if (onSuccess) {\n        onSuccess(signature);\n      }\n    } catch (e) {\n      closeSnackbar(id);\n      setSending(false);\n      console.warn(e);\n      enqueueSnackbar(e.message, { variant: 'error' });\n      if (onError) {\n        onError(e);\n      }\n    }\n  }\n\n  return [sendTransaction, sending];\n}\n\nfunction ViewTransactionOnExplorerButton({ signature }) {\n  const urlSuffix = useSolanaExplorerUrlSuffix();\n  return (\n    <Button\n      color=\"inherit\"\n      component=\"a\"\n      target=\"_blank\"\n      rel=\"noopener\"\n      href={`https://solscan.io/tx/${signature}` + urlSuffix}\n    >\n      View on Solscan\n    </Button>\n  );\n}\n\nexport function useCallAsync() {\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar();\n  return async function callAsync(\n    promise,\n    {\n      progressMessage = 'Submitting...',\n      successMessage = 'Success',\n      onSuccess,\n      onError,\n    } = {},\n  ) {\n    let id = enqueueSnackbar(progressMessage, {\n      variant: 'info',\n      persist: true,\n    });\n    try {\n      let result = await promise;\n      closeSnackbar(id);\n      if (successMessage) {\n        enqueueSnackbar(successMessage, { variant: 'success' });\n      }\n      if (onSuccess) {\n        onSuccess(result);\n      }\n    } catch (e) {\n      console.warn(e);\n      closeSnackbar(id);\n      enqueueSnackbar(e.message, { variant: 'error' });\n      if (onError) {\n        onError(e);\n      }\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}