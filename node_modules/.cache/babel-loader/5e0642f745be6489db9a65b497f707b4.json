{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/Users/jalcantara/Desktop/SOL-dev/Tanda-DAPP/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jalcantara/Desktop/SOL-dev/Tanda-DAPP/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jalcantara/Desktop/SOL-dev/Tanda-DAPP/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Typography,Paper,ListItemText,ListItem,List,Button,Collapse,ListItemIcon,Toolbar,AppBar,InputLabel,TextField,FormControlLabel,Checkbox}from'@material-ui/core';import LoadingIndicator from'./LoadingIndicator';import SendIcon from'@material-ui/icons/Send';import{useUserDomains}from'../utils/name-service';import{makeStyles}from'@material-ui/core/styles';import{PublicKey,Transaction}from'@solana/web3.js';import DnsIcon from'@material-ui/icons/Dns';import Modal from'@material-ui/core/Modal';import ExpandLess from'@material-ui/icons/ExpandLess';import ExpandMore from'@material-ui/icons/ExpandMore';import GavelIcon from'@material-ui/icons/Gavel';import{signAndSendTransaction}from'../utils/tokens';import{useSnackbar}from'notistack';import{SOL_TLD_AUTHORITY}from'../utils/name-service';import{transferNameOwnership}from'@bonfida/spl-name-service';import{useConnection}from'../utils/connection';import{useWallet}from'../utils/wallet';import{refreshCache}from'../utils/fetch-loop';import tuple from'immutable-tuple';var useStyles=makeStyles(function(theme){return{address:{textOverflow:'ellipsis',overflowX:'hidden'},buttonContainer:{display:'flex',justifyContent:'space-evenly',marginTop:theme.spacing(1),marginBottom:theme.spacing(1)},itemDetails:{marginLeft:theme.spacing(3),marginRight:theme.spacing(3),marginBottom:theme.spacing(2)},text:{color:'white',fontSize:24,marginTop:'2%',marginBottom:'2%',opacity:0.8},input:{color:'white',fontWeight:600,width:500},transferContainer:{display:'flex',flexDirection:'column',justifyContent:'center',alignItems:'center',padding:10,marginTop:theme.spacing(1),marginBottom:theme.spacing(1)},paper:{width:'50%',height:'80%',overflowY:'scroll'},modal:{display:'flex',alignItems:'center',justifyContent:'center'}};});var TransferDialog=function TransferDialog(_ref){var domainName=_ref.domainName,open=_ref.open,setOpen=_ref.setOpen;var classes=useStyles();var connection=useConnection();var wallet=useWallet();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),checked=_useState2[0],setChecked=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),newOwner=_useState4[0],setNewOwner=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var onChange=function onChange(e){setNewOwner(e.target.value.trim());};var canSumbit=newOwner&&checked;var onClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var newOwnerPubkey,instructions,_wallet$publicKey;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(newOwner){_context.next=2;break;}return _context.abrupt(\"return\",enqueueSnackbar('Invalid input',{variant:'error'}));case 2:_context.prev=2;newOwnerPubkey=new PublicKey(newOwner);_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](2);return _context.abrupt(\"return\",enqueueSnackbar('Invalid input',{variant:'error'}));case 9:_context.prev=9;setLoading(true);_context.next=13;return transferNameOwnership(connection,domainName,newOwnerPubkey,undefined,SOL_TLD_AUTHORITY);case 13:instructions=_context.sent;_context.next=16;return signAndSendTransaction(connection,new Transaction().add(instructions),wallet,[]);case 16:enqueueSnackbar('Domain name transfered',{variant:'success'});setOpen(false);_context.next=24;break;case 20:_context.prev=20;_context.t1=_context[\"catch\"](9);console.warn(\"Error transferring domain name \".concat(_context.t1));return _context.abrupt(\"return\",enqueueSnackbar('Error transferring domain name',{variant:'error'}));case 24:_context.prev=24;refreshCache(tuple('useUserDomain',wallet===null||wallet===void 0?void 0:(_wallet$publicKey=wallet.publicKey)===null||_wallet$publicKey===void 0?void 0:_wallet$publicKey.toBase58()));setLoading(false);return _context.finish(24);case 28:case\"end\":return _context.stop();}}},_callee,null,[[2,6],[9,20,24,28]]);}));return function onClick(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Modal,{style:{display:'flex',alignItems:'center',justifyContent:'center'},open:open,onClose:function onClose(){return setOpen(false);},children:/*#__PURE__*/_jsxs(Paper,{children:[/*#__PURE__*/_jsx(AppBar,{position:\"sticky\",elevation:1,children:/*#__PURE__*/_jsx(Toolbar,{children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",style:{flexGrow:1},component:\"h2\",children:\"Ownership transfer\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.transferContainer,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(InputLabel,{className:classes.text,shrink:true,children:\"New Owner\"}),/*#__PURE__*/_jsx(TextField,{placeholder:\"New owner\",InputProps:{className:classes.input},value:newOwner,onChange:onChange})]}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{checked:checked,onChange:function onChange(e){return setChecked(e.target.checked);}}),label:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"I understand that transferring ownership is irreversible\"})}),/*#__PURE__*/_jsx(Button,{onClick:onClick,disabled:!canSumbit||loading,variant:\"outlined\",color:\"primary\",style:{padding:10},children:loading?/*#__PURE__*/_jsx(LoadingIndicator,{height:\"10px\"}):'Transfer'})]})]})});};var DomainListItemDetails=function DomainListItemDetails(_ref3){var domainName=_ref3.domainName;var classes=useStyles();var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),transferVisible=_useState8[0],setTransferVisible=_useState8[1];return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:classes.buttonContainer,children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setTransferVisible(true);},startIcon:/*#__PURE__*/_jsx(SendIcon,{}),variant:\"outlined\",color:\"primary\",children:\"Transfer\"}),/*#__PURE__*/_jsx(TransferDialog,{domainName:domainName,open:transferVisible,setOpen:setTransferVisible}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return window.open(\"https://naming.bonfida.org/#/domain-registration/\".concat(domainName),'_blank');},startIcon:/*#__PURE__*/_jsx(GavelIcon,{}),variant:\"outlined\",color:\"secondary\",children:\"Sell\"})]})});};var DomainListItem=function DomainListItem(_ref4){var domainName=_ref4.domainName,domainKey=_ref4.domainKey;var classes=useStyles();var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),open=_useState10[0],setOpen=_useState10[1];return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(ListItem,{onClick:function onClick(){return setOpen(function(prev){return!prev;});},children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(DnsIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"\".concat(domainName,\".sol\"),secondary:domainKey.toBase58(),secondaryTypographyProps:{className:classes.address}}),open?/*#__PURE__*/_jsx(ExpandLess,{}):/*#__PURE__*/_jsx(ExpandMore,{})]}),/*#__PURE__*/_jsx(Collapse,{in:open,timeout:\"auto\",unmountOnExit:true,children:/*#__PURE__*/_jsx(DomainListItemDetails,{domainName:domainName})})]});};var DomainsList=function DomainsList(){var _useUserDomains=useUserDomains(),_useUserDomains2=_slicedToArray(_useUserDomains,2),userDomains=_useUserDomains2[0],userDomainsLoaded=_useUserDomains2[1];if(!userDomainsLoaded){return/*#__PURE__*/_jsx(LoadingIndicator,{});}if(userDomainsLoaded&&(userDomains===null||userDomains===void 0?void 0:userDomains.length)===0){return/*#__PURE__*/_jsx(Typography,{variant:\"body1\",align:\"center\",children:\"You don't own any domain\"});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(List,{children:userDomains===null||userDomains===void 0?void 0:userDomains.map(function(d){return/*#__PURE__*/_jsx(DomainListItem,{domainName:d.name,domainKey:d.nameKey},d.nameKey.toBase58());})})});};var DomainDialog=function DomainDialog(_ref5){var open=_ref5.open,setOpen=_ref5.setOpen;var classes=useStyles();return/*#__PURE__*/_jsx(Modal,{open:open,onClose:function onClose(){return setOpen(false);},className:classes.modal,children:/*#__PURE__*/_jsxs(Paper,{className:classes.paper,children:[/*#__PURE__*/_jsx(AppBar,{position:\"sticky\",color:\"default\",elevation:1,children:/*#__PURE__*/_jsx(Toolbar,{children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",style:{flexGrow:1},component:\"h2\",children:\"Your domains\"})})}),/*#__PURE__*/_jsx(DomainsList,{})]})});};export default DomainDialog;","map":{"version":3,"sources":["/Users/jalcantara/Desktop/SOL-dev/Tanda-DAPP/src/components/DomainsList.tsx"],"names":["React","useState","Typography","Paper","ListItemText","ListItem","List","Button","Collapse","ListItemIcon","Toolbar","AppBar","InputLabel","TextField","FormControlLabel","Checkbox","LoadingIndicator","SendIcon","useUserDomains","makeStyles","PublicKey","Transaction","DnsIcon","Modal","ExpandLess","ExpandMore","GavelIcon","signAndSendTransaction","useSnackbar","SOL_TLD_AUTHORITY","transferNameOwnership","useConnection","useWallet","refreshCache","tuple","useStyles","theme","address","textOverflow","overflowX","buttonContainer","display","justifyContent","marginTop","spacing","marginBottom","itemDetails","marginLeft","marginRight","text","color","fontSize","opacity","input","fontWeight","width","transferContainer","flexDirection","alignItems","padding","paper","height","overflowY","modal","TransferDialog","domainName","open","setOpen","classes","connection","wallet","checked","setChecked","newOwner","setNewOwner","loading","setLoading","enqueueSnackbar","onChange","e","target","value","trim","canSumbit","onClick","variant","newOwnerPubkey","undefined","instructions","add","console","warn","publicKey","toBase58","flexGrow","className","DomainListItemDetails","transferVisible","setTransferVisible","window","DomainListItem","domainKey","prev","DomainsList","userDomains","userDomainsLoaded","length","map","d","name","nameKey","DomainDialog"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport {\n  Typography,\n  Paper,\n  ListItemText,\n  ListItem,\n  List,\n  Button,\n  Collapse,\n  ListItemIcon,\n  Toolbar,\n  AppBar,\n  InputLabel,\n  TextField,\n  FormControlLabel,\n  Checkbox,\n} from '@material-ui/core';\nimport LoadingIndicator from './LoadingIndicator';\nimport SendIcon from '@material-ui/icons/Send';\nimport { useUserDomains } from '../utils/name-service';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { PublicKey, Transaction } from '@solana/web3.js';\nimport DnsIcon from '@material-ui/icons/Dns';\nimport Modal from '@material-ui/core/Modal';\nimport ExpandLess from '@material-ui/icons/ExpandLess';\nimport ExpandMore from '@material-ui/icons/ExpandMore';\nimport GavelIcon from '@material-ui/icons/Gavel';\nimport { signAndSendTransaction } from '../utils/tokens';\nimport { useSnackbar } from 'notistack';\nimport { SOL_TLD_AUTHORITY } from '../utils/name-service';\nimport { transferNameOwnership } from '@bonfida/spl-name-service';\nimport { useConnection } from '../utils/connection';\nimport { useWallet } from '../utils/wallet';\nimport { refreshCache } from '../utils/fetch-loop';\nimport tuple from 'immutable-tuple';\n\nconst useStyles = makeStyles((theme) => ({\n  address: {\n    textOverflow: 'ellipsis',\n    overflowX: 'hidden',\n  },\n  buttonContainer: {\n    display: 'flex',\n    justifyContent: 'space-evenly',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1),\n  },\n  itemDetails: {\n    marginLeft: theme.spacing(3),\n    marginRight: theme.spacing(3),\n    marginBottom: theme.spacing(2),\n  },\n  text: {\n    color: 'white',\n    fontSize: 24,\n    marginTop: '2%',\n    marginBottom: '2%',\n    opacity: 0.8,\n  },\n  input: {\n    color: 'white',\n    fontWeight: 600,\n    width: 500,\n  },\n  transferContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 10,\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1),\n  },\n  paper: {\n    width: '50%',\n    height: '80%',\n    overflowY: 'scroll',\n  },\n  modal: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n}));\n\nconst TransferDialog = ({\n  domainName,\n  open,\n  setOpen,\n}: {\n  domainName: string;\n  open: boolean;\n  setOpen: (args: boolean) => void;\n}) => {\n  const classes = useStyles();\n  const connection = useConnection();\n  const wallet = useWallet();\n  const [checked, setChecked] = useState(false);\n  const [newOwner, setNewOwner] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n  const { enqueueSnackbar } = useSnackbar();\n\n  const onChange = (e) => {\n    setNewOwner(e.target.value.trim());\n  };\n  const canSumbit = newOwner && checked;\n  const onClick = async () => {\n    if (!newOwner) {\n      return enqueueSnackbar('Invalid input', { variant: 'error' });\n    }\n    let newOwnerPubkey: PublicKey;\n    try {\n      newOwnerPubkey = new PublicKey(newOwner);\n    } catch {\n      return enqueueSnackbar('Invalid input', { variant: 'error' });\n    }\n    try {\n      setLoading(true);\n      const instructions = await transferNameOwnership(\n        connection,\n        domainName,\n        newOwnerPubkey,\n        undefined,\n        SOL_TLD_AUTHORITY,\n      );\n      await signAndSendTransaction(\n        connection,\n        new Transaction().add(instructions),\n        wallet,\n        [],\n      );\n      enqueueSnackbar('Domain name transfered', { variant: 'success' });\n      setOpen(false);\n    } catch (err) {\n      console.warn(`Error transferring domain name ${err}`);\n      return enqueueSnackbar('Error transferring domain name', {\n        variant: 'error',\n      });\n    } finally {\n      refreshCache(tuple('useUserDomain', wallet?.publicKey?.toBase58()));\n      setLoading(false);\n    }\n  };\n  return (\n    <Modal\n      style={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n      }}\n      open={open}\n      onClose={() => setOpen(false)}\n    >\n      <Paper>\n        <AppBar position=\"sticky\" elevation={1}>\n          <Toolbar>\n            <Typography variant=\"h6\" style={{ flexGrow: 1 }} component=\"h2\">\n              Ownership transfer\n            </Typography>\n          </Toolbar>\n        </AppBar>\n        <div className={classes.transferContainer}>\n          <div>\n            <InputLabel className={classes.text} shrink>\n              New Owner\n            </InputLabel>\n            <TextField\n              placeholder=\"New owner\"\n              InputProps={{\n                className: classes.input,\n              }}\n              value={newOwner}\n              onChange={onChange}\n            />\n          </div>\n          <FormControlLabel\n            control={\n              <Checkbox\n                checked={checked}\n                onChange={(e) => setChecked(e.target.checked)}\n              />\n            }\n            label={\n              <Typography variant=\"body2\">\n                I understand that transferring ownership is irreversible\n              </Typography>\n            }\n          />\n          <Button\n            onClick={onClick}\n            disabled={!canSumbit || loading}\n            variant=\"outlined\"\n            color=\"primary\"\n            style={{ padding: 10 }}\n          >\n            {loading ? <LoadingIndicator height=\"10px\" /> : 'Transfer'}\n          </Button>\n        </div>\n      </Paper>\n    </Modal>\n  );\n};\n\nconst DomainListItemDetails = ({ domainName }: { domainName: string }) => {\n  const classes = useStyles();\n  const [transferVisible, setTransferVisible] = useState(false);\n  return (\n    <>\n      <div className={classes.buttonContainer}>\n        <Button\n          onClick={() => setTransferVisible(true)}\n          startIcon={<SendIcon />}\n          variant=\"outlined\"\n          color=\"primary\"\n        >\n          Transfer\n        </Button>\n        <TransferDialog\n          domainName={domainName}\n          open={transferVisible}\n          setOpen={setTransferVisible}\n        />\n        <Button\n          onClick={() =>\n            window.open(\n              `https://naming.bonfida.org/#/domain-registration/${domainName}`,\n              '_blank',\n            )\n          }\n          startIcon={<GavelIcon />}\n          variant=\"outlined\"\n          color=\"secondary\"\n        >\n          Sell\n        </Button>\n      </div>\n    </>\n  );\n};\n\nconst DomainListItem = ({\n  domainName,\n  domainKey,\n}: {\n  domainName: string;\n  domainKey: PublicKey;\n}) => {\n  const classes = useStyles();\n  const [open, setOpen] = useState(false);\n  return (\n    <>\n      <ListItem onClick={() => setOpen((prev) => !prev)}>\n        <ListItemIcon>\n          <DnsIcon />\n        </ListItemIcon>\n        <ListItemText\n          primary={`${domainName}.sol`}\n          secondary={domainKey.toBase58()}\n          secondaryTypographyProps={{ className: classes.address }}\n        />\n        {open ? <ExpandLess /> : <ExpandMore />}\n      </ListItem>\n      <Collapse in={open} timeout=\"auto\" unmountOnExit>\n        <DomainListItemDetails domainName={domainName} />\n      </Collapse>\n    </>\n  );\n};\n\nconst DomainsList = () => {\n  const [userDomains, userDomainsLoaded] = useUserDomains();\n  if (!userDomainsLoaded) {\n    return <LoadingIndicator />;\n  }\n  if (userDomainsLoaded && userDomains?.length === 0) {\n    return (\n      <Typography variant=\"body1\" align=\"center\">\n        You don't own any domain\n      </Typography>\n    );\n  }\n  return (\n    <>\n      <List>\n        {userDomains?.map((d) => {\n          return (\n            <DomainListItem\n              key={d.nameKey.toBase58()}\n              domainName={d.name}\n              domainKey={d.nameKey}\n            />\n          );\n        })}\n      </List>\n    </>\n  );\n};\n\nconst DomainDialog = ({\n  open,\n  setOpen,\n}: {\n  open: boolean;\n  setOpen: (arg: boolean) => void;\n}) => {\n  const classes = useStyles();\n  return (\n    <Modal open={open} onClose={() => setOpen(false)} className={classes.modal}>\n      <Paper className={classes.paper}>\n        <AppBar position=\"sticky\" color=\"default\" elevation={1}>\n          <Toolbar>\n            <Typography variant=\"h6\" style={{ flexGrow: 1 }} component=\"h2\">\n              Your domains\n            </Typography>\n          </Toolbar>\n        </AppBar>\n        <DomainsList />\n      </Paper>\n    </Modal>\n  );\n};\n\nexport default DomainDialog;\n"]},"metadata":{},"sourceType":"module"}