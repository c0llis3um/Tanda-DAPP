{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jalcantara/Desktop/SOL-dev/tanda-wallet-sol/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/Users/jalcantara/Desktop/SOL-dev/tanda-wallet-sol/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/Users/jalcantara/Desktop/SOL-dev/tanda-wallet-sol/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useCallback,useEffect,useRef,useState}from'react';import{Keypair}from'@solana/web3.js';import{useMediaQuery}from'@material-ui/core';import*as bs58 from'bs58';export function sleep(_x){return _sleep.apply(this,arguments);}function _sleep(){_sleep=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(ms){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",new Promise(function(resolve){return setTimeout(resolve,ms);}));case 1:case\"end\":return _context.stop();}}},_callee);}));return _sleep.apply(this,arguments);}export function useLocalStorageState(key,defaultState){var _useState=useState(function(){var storedState=localStorage.getItem(key);if(storedState){return JSON.parse(storedState);}return defaultState;}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var setLocalStorageState=useCallback(function(newState){var changed=state!==newState;if(!changed){return;}setState(newState);if(newState===null){localStorage.removeItem(key);}else{localStorage.setItem(key,JSON.stringify(newState));}},[state,key]);return[state,setLocalStorageState];}export function useEffectAfterTimeout(effect,timeout){useEffect(function(){var handle=setTimeout(effect,timeout);return function(){return clearTimeout(handle);};});}export function useListener(emitter,eventName){var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),forceUpdate=_useState4[1];useEffect(function(){var listener=function listener(){return forceUpdate(function(i){return i+1;});};emitter.on(eventName,listener);return function(){return emitter.removeListener(eventName,listener);};},[emitter,eventName]);}export function useRefEqual(value,areEqual){var prevRef=useRef(value);if(prevRef.current!==value&&!areEqual(prevRef.current,value)){prevRef.current=value;}return prevRef.current;}export function abbreviateAddress(address){var base58=address.toBase58();return base58.slice(0,4)+'…'+base58.slice(base58.length-4);}export function confirmTransaction(_x2,_x3){return _confirmTransaction.apply(this,arguments);}// TODO consolidate popup dimensions\nfunction _confirmTransaction(){_confirmTransaction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(connection,signature){var startTime,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:startTime=new Date();_context2.next=3;return connection.confirmTransaction(signature,'recent');case 3:result=_context2.sent;if(!result.value.err){_context2.next=6;break;}throw new Error('Error confirming transaction: '+JSON.stringify(result.value.err));case 6:console.log('Transaction confirmed after %sms',new Date().getTime()-startTime.getTime());return _context2.abrupt(\"return\",result.value);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return _confirmTransaction.apply(this,arguments);}export function useIsExtensionWidth(){return useMediaQuery('(max-width:450px)');}export var isExtension=window.location.protocol==='chrome-extension:';export var isExtensionPopup=isExtension&&window.opener;/**\n * Returns an account object when given the private key\n */export var decodeAccount=function decodeAccount(privateKey){try{return Keypair.fromSecretKey(new Uint8Array(JSON.parse(privateKey)));}catch(_){try{return Keypair.fromSecretKey(new Uint8Array(bs58.decode(privateKey)));}catch(_){return undefined;}}};// shorten the checksummed version of the input address to have 4 characters at start and end\nexport function shortenAddress(address){var chars=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4;return\"\".concat(address.slice(0,chars),\"...\").concat(address.slice(-chars));}","map":{"version":3,"sources":["/Users/jalcantara/Desktop/SOL-dev/tanda-wallet-sol/src/utils/utils.ts"],"names":["useCallback","useEffect","useRef","useState","Keypair","useMediaQuery","bs58","sleep","ms","Promise","resolve","setTimeout","useLocalStorageState","key","defaultState","storedState","localStorage","getItem","JSON","parse","state","setState","setLocalStorageState","newState","changed","removeItem","setItem","stringify","useEffectAfterTimeout","effect","timeout","handle","clearTimeout","useListener","emitter","eventName","forceUpdate","listener","i","on","removeListener","useRefEqual","value","areEqual","prevRef","current","abbreviateAddress","address","base58","toBase58","slice","length","confirmTransaction","connection","signature","startTime","Date","result","err","Error","console","log","getTime","useIsExtensionWidth","isExtension","window","location","protocol","isExtensionPopup","opener","decodeAccount","privateKey","fromSecretKey","Uint8Array","_","decode","undefined","shortenAddress","chars"],"mappings":"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","sourcesContent":["import { useCallback, useEffect, useRef, useState } from 'react';\nimport { Keypair, Connection, PublicKey } from '@solana/web3.js';\nimport { useMediaQuery } from '@material-ui/core';\nimport * as bs58 from 'bs58';\n\nexport async function sleep(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n\nexport function useLocalStorageState<T>(\n  key: string,\n  defaultState: T,\n): [T, (T) => void] {\n  const [state, setState] = useState(() => {\n    let storedState = localStorage.getItem(key);\n    if (storedState) {\n      return JSON.parse(storedState);\n    }\n    return defaultState;\n  });\n\n  const setLocalStorageState = useCallback(\n    (newState) => {\n      let changed = state !== newState;\n      if (!changed) {\n        return;\n      }\n      setState(newState);\n      if (newState === null) {\n        localStorage.removeItem(key);\n      } else {\n        localStorage.setItem(key, JSON.stringify(newState));\n      }\n    },\n    [state, key],\n  );\n\n  return [state, setLocalStorageState];\n}\n\nexport function useEffectAfterTimeout(effect: () => void, timeout: number) {\n  useEffect(() => {\n    let handle = setTimeout(effect, timeout);\n    return () => clearTimeout(handle);\n  });\n}\n\nexport function useListener(emitter, eventName: string) {\n  let [, forceUpdate] = useState(0);\n  useEffect(() => {\n    let listener = () => forceUpdate((i) => i + 1);\n    emitter.on(eventName, listener);\n    return () => emitter.removeListener(eventName, listener);\n  }, [emitter, eventName]);\n}\n\nexport function useRefEqual<T>(\n  value: T,\n  areEqual: (oldValue: T, newValue: T) => boolean,\n): T {\n  const prevRef = useRef<T>(value);\n  if (prevRef.current !== value && !areEqual(prevRef.current, value)) {\n    prevRef.current = value;\n  }\n  return prevRef.current;\n}\n\nexport function abbreviateAddress(address: PublicKey) {\n  let base58 = address.toBase58();\n  return base58.slice(0, 4) + '…' + base58.slice(base58.length - 4);\n}\n\nexport async function confirmTransaction(\n  connection: Connection,\n  signature: string,\n) {\n  let startTime = new Date();\n  let result = await connection.confirmTransaction(signature, 'recent');\n  if (result.value.err) {\n    throw new Error(\n      'Error confirming transaction: ' + JSON.stringify(result.value.err),\n    );\n  }\n  console.log(\n    'Transaction confirmed after %sms',\n    new Date().getTime() - startTime.getTime(),\n  );\n  return result.value;\n}\n\n// TODO consolidate popup dimensions\nexport function useIsExtensionWidth() {\n  return useMediaQuery('(max-width:450px)');\n}\n\nexport const isExtension = window.location.protocol === 'chrome-extension:';\n\nexport const isExtensionPopup = isExtension && window.opener;\n/**\n * Returns an account object when given the private key\n */\nexport const decodeAccount = (privateKey: string) => {\n  try {\n    return Keypair.fromSecretKey(new Uint8Array(JSON.parse(privateKey)));\n  } catch (_) {\n    try {\n      return Keypair.fromSecretKey(new Uint8Array(bs58.decode(privateKey)));\n    } catch (_) {\n      return undefined;\n    }\n  }\n}\n\n// shorten the checksummed version of the input address to have 4 characters at start and end\nexport function shortenAddress(address: string, chars = 4): string {\n  return `${address.slice(0, chars)}...${address.slice(-chars)}`;\n}"]},"metadata":{},"sourceType":"module"}